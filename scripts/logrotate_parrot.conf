# Logrotate configuration for Parrot MCP Server
# Installation:
#   sudo cp scripts/logrotate_parrot.conf /etc/logrotate.d/parrot
#   sudo chown root:root /etc/logrotate.d/parrot
#   sudo chmod 644 /etc/logrotate.d/parrot
#
# Test configuration:
#   sudo logrotate -d /etc/logrotate.d/parrot
#
# Manual rotation:
#   sudo logrotate -f /etc/logrotate.d/parrot

/home/*/parrot_mcp_server/logs/*.log {
    # Rotate when log file reaches 100M
    size 100M
    
    # Keep 30 rotated logs
    rotate 30
    
    # Don't rotate if log is empty
    notifempty
    
    # Create new log file with specific permissions
    create 0640 runner runner
    
    # Compress rotated logs (using gzip by default)
    compress
    
    # Delay compression until next rotation
    # (allows tools to finish writing to just-rotated file)
    delaycompress
    
    # Don't error if log file is missing
    missingok
    
    # Use date as suffix for rotated files (e.g., parrot.log-20240115)
    dateext
    dateformat -%Y%m%d
    
    # Rotate logs daily if size limit not reached
    # (can be changed to 'weekly' or 'monthly' as needed)
    daily
    
    # Post-rotation script (optional)
    # Uncomment to restart services or send notifications
    # postrotate
    #     /usr/bin/pkill -HUP -f parrot_mcp_server || true
    # endscript
}
