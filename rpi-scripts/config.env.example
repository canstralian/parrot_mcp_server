# Parrot MCP Server Configuration
# Copy this file to config.env and customize for your environment
# Usage: source config.env in your scripts

# ============================================================================
# PATHS AND DIRECTORIES
# ============================================================================

# Base directory for Parrot MCP Server (auto-detected if not set)
# PARROT_BASE_DIR="/opt/parrot"

# Script directory (usually auto-detected)
# PARROT_SCRIPT_DIR="${PARROT_BASE_DIR}/rpi-scripts"

# Log directory - where all log files are stored
PARROT_LOG_DIR="./logs"

# IPC directory - Use a secure directory for production.
# Recommended: /run/parrot-mcp (system-wide) or ${HOME}/.parrot-mcp (per-user)
# /tmp is insecure and should only be used for development/testing.
# See SECURITY.md for details on secure IPC configuration.
PARROT_IPC_DIR="/run/parrot-mcp"
# For per-user installs, you may use: PARROT_IPC_DIR="${HOME}/.parrot-mcp"

# PID file location
PARROT_PID_FILE="${PARROT_LOG_DIR}/mcp_server.pid"

# ============================================================================
# LOGGING CONFIGURATION
# ============================================================================

# Main MCP server log file
PARROT_SERVER_LOG="${PARROT_LOG_DIR}/parrot.log"

# CLI error log file
PARROT_CLI_LOG="${PARROT_LOG_DIR}/cli_error.log"

# Health check log file
PARROT_HEALTH_LOG="${PARROT_LOG_DIR}/health_check.log"

# Daily workflow log file
PARROT_WORKFLOW_LOG="${PARROT_LOG_DIR}/daily_workflow.log"

# Log rotation settings
PARROT_LOG_MAX_SIZE="10M"        # Maximum log file size before rotation
PARROT_LOG_MAX_AGE="30"          # Days to keep rotated logs
PARROT_LOG_ROTATION_COUNT="5"    # Number of rotated logs to keep

# Log level: DEBUG, INFO, WARN, ERROR
PARROT_LOG_LEVEL="INFO"

# ============================================================================
# MCP SERVER CONFIGURATION
# ============================================================================

# MCP input file (for current file-based IPC)
PARROT_MCP_INPUT="${PARROT_IPC_DIR}/mcp_in.json"

# MCP malformed message file
PARROT_MCP_BAD="${PARROT_IPC_DIR}/mcp_bad.json"

# MCP server port (for future network implementation)
# PARROT_MCP_PORT="3000"

# MCP server host (for future network implementation)
# PARROT_MCP_HOST="127.0.0.1"

# Enable TLS/SSL (future feature)
# PARROT_MCP_TLS="false"

# ============================================================================
# SYSTEM MONITORING THRESHOLDS
# ============================================================================

# Disk usage warning threshold (percentage)
PARROT_DISK_THRESHOLD="80"

# System load average threshold (1-minute load average)
PARROT_LOAD_THRESHOLD="2.0"

# Memory usage warning threshold (percentage)
PARROT_MEM_THRESHOLD="90"

# ============================================================================
# NOTIFICATION SETTINGS
# ============================================================================

# Email for health check alerts (leave empty to disable email notifications)
PARROT_ALERT_EMAIL=""

# Email for workflow notifications (leave empty to disable)
PARROT_NOTIFY_EMAIL=""

# Email subject prefix
PARROT_EMAIL_PREFIX="[Parrot MCP]"

# ============================================================================
# MAINTENANCE SETTINGS
# ============================================================================

# Enable automatic system updates (true/false)
PARROT_AUTO_UPDATE="false"

# Enable automatic cache cleaning (true/false)
PARROT_AUTO_CLEAN="true"

# Maximum age for cache files (days)
PARROT_CACHE_MAX_AGE="7"

# Backup directory
PARROT_BACKUP_DIR="${HOME}/backups"

# Backup retention period (days)
PARROT_BACKUP_RETENTION="30"

# ============================================================================
# SECURITY SETTINGS
# ============================================================================

# Run server as specific user (leave empty for current user)
PARROT_RUN_AS_USER=""

# Strict file permission checks (true/false)
PARROT_STRICT_PERMS="true"

# Input validation level: STRICT, NORMAL, RELAXED
PARROT_VALIDATION_LEVEL="STRICT"

# Maximum input size for MCP messages (bytes)
PARROT_MAX_INPUT_SIZE="1048576"  # 1MB

# ============================================================================
# RETRY AND TIMEOUT SETTINGS
# ============================================================================

# Number of retry attempts for failed operations
PARROT_RETRY_COUNT="3"

# Delay between retries (seconds)
PARROT_RETRY_DELAY="5"

# Command timeout (seconds)
PARROT_COMMAND_TIMEOUT="300"  # 5 minutes

# ============================================================================
# DEVELOPMENT AND DEBUGGING
# ============================================================================

# Enable debug mode (verbose logging)
PARROT_DEBUG="false"

# Enable dry-run mode (no actual changes made)
PARROT_DRY_RUN="false"

# Enable trace mode (set -x in scripts)
PARROT_TRACE="false"

# ============================================================================
# CRON SCHEDULE (used by setup_cron.sh)
# ============================================================================

# Daily workflow schedule (cron format)
PARROT_CRON_DAILY="0 2 * * *"  # 2 AM daily

# Weekly backup schedule
PARROT_CRON_BACKUP="0 3 * * 0"  # 3 AM Sunday

# Hourly health check schedule
PARROT_CRON_HEALTH="0 * * * *"  # Every hour

# ============================================================================
# ADVANCED SETTINGS
# ============================================================================

# Use FIFO pipes instead of files for IPC (future feature)
# PARROT_USE_FIFO="false"

# Enable AppArmor/SELinux profiles (future feature)
# PARROT_USE_SECURITY_PROFILE="false"

# Enable metrics collection (future feature)
# PARROT_ENABLE_METRICS="false"

# Metrics endpoint (future feature)
# PARROT_METRICS_ENDPOINT="http://localhost:9090/metrics"

# ============================================================================
# SECURITY TOOLS CONFIGURATION (see docs/SECURITY_TOOLS.md)
# ============================================================================
#
# ⚠️  WARNING: FOR AUTHORIZED SECURITY TESTING ONLY
# Unauthorized use of security tools is ILLEGAL. Read LEGAL_NOTICE.txt.
#

# Enable security tools (default: false for safety)
SECURITY_TOOLS_ENABLED="false"

# Security tools directory
SECURITY_TOOLS_DIR="${PARROT_SCRIPT_DIR}/security-tools"

# Scan results directory
SECURITY_RESULTS_DIR="${SECURITY_TOOLS_DIR}/scan-results"

# Security audit log (separate from main logs)
SECURITY_AUDIT_LOG="${PARROT_LOG_DIR}/security_audit.log"

# Require API key authentication
SECURITY_REQUIRE_AUTH="true"

# Authorized operators (comma-separated usernames)
SECURITY_AUTHORIZED_USERS="root,pi,admin"

# Maximum scans per hour per user
SECURITY_MAX_SCANS_PER_HOUR="10"

# Minimum seconds between scans
SECURITY_MIN_SCAN_INTERVAL="60"

# Encrypt scan results at rest
SECURITY_ENCRYPT_RESULTS="true"

# Encryption method: gpg or openssl
SECURITY_ENCRYPTION_METHOD="gpg"

# GPG key ID for encryption (leave empty to disable GPG encryption)
SECURITY_GPG_KEY_ID=""

# Results retention period (days)
SECURITY_RESULTS_RETENTION_DAYS="30"

# Nmap configuration
NMAP_MAX_INTENSITY="3"
NMAP_MAX_PORTS="1000"
NMAP_TIMEOUT="300"

# OpenVAS configuration
OPENVAS_MAX_CONCURRENT_SCANS="2"
OPENVAS_TIMEOUT="3600"

# Use Docker for sandboxing (requires Docker)
SECURITY_USE_DOCKER="false"

# Notification settings for security operations
SECURITY_NOTIFY_EMAIL="${PARROT_ALERT_EMAIL}"
SECURITY_NOTIFY_ON_COMPLETION="true"
SECURITY_NOTIFY_ON_ERROR="true"

# ============================================================================
# NOTES
# ============================================================================
#
# 1. Variables with defaults will use the default if not set here
# 2. Empty values ("") typically disable features (e.g., email notifications)
# 3. Boolean values should be lowercase: "true" or "false"
# 4. Paths can be absolute or relative (relative to script directory)
# 5. Always quote values to handle spaces and special characters
# 6. See SECURITY.md for security best practices
# 7. See docs/LOGGING.md for logging format specifications
# 8. See docs/SECURITY_TOOLS.md for security tools usage and legal requirements
#
# ============================================================================
